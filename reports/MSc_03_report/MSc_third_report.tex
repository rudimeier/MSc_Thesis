%\section{FitzHugh-Nagumo Model Dynamics in [PAN12] and [GHO08]}
%
\documentclass[12pt]{article}
\usepackage{geometry}
\geometry{
 a4paper,
 total={210mm,297mm},
 left=40mm,
 right=20mm,
 top=35mm,
 bottom=35mm, }


\usepackage[utf8]{inputenc}
\usepackage{authblk}
\usepackage{graphicx}
\usepackage[font=small,labelfont=bf]{caption}
\usepackage{amsmath}



\title{MSc Thesis : Simulation of Brain Functional Connectivity on Emprical and Randomized Complex Networks, \\ 3rd Report}
\author[1]{\c{S}eyma Bayrak \thanks{seyma.bayrak@st.ovgu.de}}
\author[ ]{\\ Advisers: Philipp H\"{o}vel, Vesna Vuksanovi\'c}
\affil[1]{\footnotesize{Integrative Neuroscience MSc, Otto von Guericke University, Magdeburg}}



\date{June 2014}
\begin{document}
   \maketitle
This work aims to compare my current simulation results with the previously done work and visualize the correlation matrices of simulated neuronal activity as well as simulated BOLD signal. The correlation matrices are all obtained by calculating column-wise correlation coefficients straightforward in all given data matrices. 

\newpage

\begin{table}[h]
		\caption{$r$ is the threshold value, $\sigma$ is the coupling strength parameters. All the columns presents the Pearson correlation coefficients between the empirical data set and simulated data sets with given parameters: $v=70[m/s]$, $D=0.05$, $tmax=550[s]$. The empirical data is an fMRI-BOLD correlation matrix (source: $A\_aal.txt$) and simulated data is obtained from the FitzHugh-Nagumo model for the neuronal activity (FHN column), Balloon-Windkessel model for the BOLD activity (BOLD-signal), low-pass filtered BOLD activity (filt. BOLD) and then downsampled BOLD activity (downs.BOLD). Diagonal elements in both matrices are ignored while calculating Pearson's coefficients. 	}
	\begin{tabular}{l | c | c | c | c | c | c } \hline
$r$  &  $\sigma$ & FHN     & BOLD-signal & filt. BOLD    & downs. BOLD & prev. work  \\ \hline \hline
0.57 &  0.018 	 & 0.0709  &	0.1284	 &	-0.0814		 &	0.0770	   & 0.35   	    \\ \hline
0.58 &  0.018    & 0.0538  &	0.4275	 &	0.0504		 &	0.3647	   & 0.40			\\ \hline
0.59 &  0.020    & 0.0549  &	0.1234	 &	-0.1364		 &	0.0574	   & 0.35			\\ \hline
0.60 &  0.020    & -0.1963 &	0.0703	 &	-0.2232		 &	0.0323	   & 0.33			\\ \hline
0.63 &  0.025    & +0.0006 &	0.2223	 &	-0.1394		 &	0.1415	   & 0.41			\\ \hline
0.64 &  0.025    & -0.0564 &	0.1945	 &	-0.1325		 &	0.1390	   & 0.40			\\ \hline
0.64 &  0.030    & +0.0482 &	0.0790	 &	-0.1322		 &	0.0297	   & 0.34			\\ \hline
0.65 &  0.025    & -0.1734 &	0.1343	 &	-0.1913		 &	0.0662	   & 0.34    		\\ \hline
	\end{tabular}  
\end{table}    



\begin{table}
		\caption{Diagonal elements in both (empirical and simulated) matrices  are set to $1.0$, while calculating Pearson's correlation coefficients. 	}
	\begin{tabular}{l | c | c | c | c | c | c } \hline
$r$  &  $\sigma$ & FHN     & BOLD-signal & filt. BOLD    & downs. BOLD & prev. work  \\ \hline \hline
0.57 &  0.018 	 & 0.1662  &	0.3111	 &	0.0257		 &	0.3128	   & 0.35   	    \\ \hline
0.58 &  0.018    & 0.2130  &	0.4977	 &	0.1340		 &	0.4687	   & 0.40			\\ \hline
0.59 &  0.020    & 0.1510  &	0.3601	 &	-0.0361		 &	0.3266	   & 0.35			\\ \hline
0.60 &  0.020    & 0.2525  &	0.3488	 &	-0.1188		 &	0.3198	   & 0.33			\\ \hline
0.63 &  0.025    & 0.2182  &	0.4139	 &	-0.0464		 &	0.3695	   & 0.41			\\ \hline
0.64 &  0.025    & 0.2209  &	0.3882	 &	-0.0522		 &	0.3653	   & 0.40			\\ \hline
0.64 &  0.030    & 0.1759  &	0.3354	 &	-0.0380		 &	0.3148	   & 0.34			\\ \hline
0.65 &  0.025    & 0.2268  &	0.3710	 &	-0.1126		 &	0.3344	   & 0.34    		\\ \hline
	\end{tabular}
  
\end{table}  

\newpage


\subsection{Correlation Matrices of Simulated Neuronal Activity}

\begin{figure}[htp!]
  \centering
    \begin{tabular}{cc}
    % Requires \usepackage{graphicx}
    \includegraphics[width=0.48\textwidth, height=48mm]{FHN_corr_r_0_57_si_0_018.eps} &
    \includegraphics[width=0.48\textwidth, height=48mm]{FHN_corr_r_0_58_si_0_018.eps}\\

    \includegraphics[width=0.48\textwidth, height=48mm]{FHN_corr_r_0_59_si_0_020.eps} &
    \includegraphics[width=0.48\textwidth, height=48mm]{FHN_corr_r_0_60_si_0_020.eps}\\

    \includegraphics[width=0.48\textwidth, height=48mm]{FHN_corr_r_0_63_si_0_025.eps} &
    \includegraphics[width=0.48\textwidth, height=48mm]{FHN_corr_r_0_64_si_0_025.eps}\\

    \includegraphics[width=0.48\textwidth, height=48mm]{FHN_corr_r_0_64_si_0_030.eps} &
    \includegraphics[width=0.48\textwidth, height=48mm]{FHN_corr_r_0_65_si_0_025.eps}\\


  \end{tabular}

 \label{figur}\caption{ Each square represents the correlation of simulated timeseries of two nodes. Diagonals are equal to 1.0. The FHN model is simulated for $T=550[s]=9.17[min]$. }

\end{figure}


\subsection{Correlation Matrices of Simulated BOLD Activity}

\begin{figure}[htp!]
  \centering
    \begin{tabular}{cc}
    % Requires \usepackage{graphicx}
    \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_signal_corr_r_0_57_si_0_018.eps} &
 	\includegraphics[width=0.48\textwidth, height=48mm]{BOLD_signal_corr_r_0_58_si_0_018.eps}\\

    \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_signal_corr_r_0_59_si_0_020.eps} &
 	\includegraphics[width=0.48\textwidth, height=48mm]{BOLD_signal_corr_r_0_60_si_0_020.eps}\\

    \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_signal_corr_r_0_63_si_0_025.eps} &
 	\includegraphics[width=0.48\textwidth, height=48mm]{BOLD_signal_corr_r_0_64_si_0_025.eps}\\

    \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_signal_corr_r_0_64_si_0_030.eps} &
 	\includegraphics[width=0.48\textwidth, height=48mm]{BOLD_signal_corr_r_0_65_si_0_025.eps}\\


  \end{tabular}

 \label{figur}\caption{Diagonals are equal to 1.0. The signal is cut from the beginning by amount of $20[s]$, the corresponding time of the signal used for visualization is $T=530[s]=8.83[min]$.  }

\end{figure}
 


\subsection{Correlation Matrices of Filetered BOLD Activity}


\begin{figure}[htp!]
  \centering
    \begin{tabular}{cc}
    % Requires \usepackage{graphicx}
    \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_filtered_corr_r_0_57_si_0_018.eps} &
    \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_filtered_corr_r_0_58_si_0_018.eps}\\

    \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_filtered_corr_r_0_59_si_0_020.eps} &
    \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_filtered_corr_r_0_60_si_0_020.eps}\\

    \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_filtered_corr_r_0_63_si_0_025.eps} &
    \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_filtered_corr_r_0_64_si_0_025.eps}\\

    \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_filtered_corr_r_0_64_si_0_030.eps} &
    \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_filtered_corr_r_0_65_si_0_025.eps}\\

  \end{tabular}

 \label{figur}\caption{Diagonals are equal to 1.0. A 5th order butterworth low-pass filter with cut-off frequency $Wn = 0.005 [Hz]$ is applied on BOLD activity simulation.  }

\end{figure}



\subsection{Correlation Matrices of Downsampled BOLD Activity}


\begin{figure}[htp!]
  \centering
    \begin{tabular}{cc}
    % Requires \usepackage{graphicx}
    \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_bds_corr_r_0_57_si_0_018.eps} &
 \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_bds_corr_r_0_58_si_0_018.eps} \\
 
     \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_bds_corr_r_0_59_si_0_020.eps} &
 \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_bds_corr_r_0_60_si_0_020.eps} \\

     \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_bds_corr_r_0_63_si_0_025.eps} &
 \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_bds_corr_r_0_64_si_0_025.eps} \\
 
      \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_bds_corr_r_0_64_si_0_030.eps} &
 \includegraphics[width=0.48\textwidth, height=48mm]{BOLD_bds_corr_r_0_65_si_0_025.eps} \\


  \end{tabular}

 \label{figur}\caption{Diagonals are equal to 1.0. The filtered BOLD activity simulation is downsampled by choosing each point in every 2300 points.  }

\end{figure}

\subsection{Empirical Correlation Matrix}

\begin{figure}[htp!]
	\centering
	 \includegraphics[width=0.6\textwidth]{A_aal.eps}

\label{figur}\caption{ $A\_aal.txt$ }

\end{figure}




\subsection{FHN timeseries of nodes }

\begin{figure}[htp!]
  \centering
    \begin{tabular}{cc}
    % Requires \usepackage{graphicx}
  \includegraphics[width=0.4\textwidth, height=44mm]{A_aal.eps} &    
  \includegraphics[width=0.5\textwidth, height=44mm]{nodes_FHN_good_correlation.eps}\\ 

    \includegraphics[width=0.4\textwidth, height=44mm]{FHN_corr_r_0_58_si_0_018.eps} &  
  \includegraphics[width=0.5\textwidth, height=44mm]{nodes_FHN_bad_correlation.eps} \\

	\end{tabular}
	
	\label{figur}\caption{On the left : correlation matrices of empirical data and simulated neuronal activity. The Pearson correlation between them is 0.2130. On the right : the simulated timeseries of the best correlated nodes, as well as the worst correlated nodes. The time resolution is set to $dt=0.001[s]$. Total time of simulation is $T=550[s]=9.17[min]$.}
	
\end{figure}




\subsection{Simulated BOLD activity of nodes }

\begin{figure}[htp!]
  \centering
    \begin{tabular}{cc}
    % Requires \usepackage{graphicx}
  \includegraphics[width=0.4\textwidth, height=40mm]{A_aal.eps} &    
  \includegraphics[width=0.5\textwidth, height=40mm]{nodes_BOLD_signal_good_correlation.eps}\\ 

    \includegraphics[width=0.4\textwidth, height=40mm]{BOLD_signal_corr_r_0_58_si_0_018.eps} &  
  \includegraphics[width=0.5\textwidth, height=40mm]{nodes_BOLD_signal_bad_correlation.eps} \\

	\end{tabular}
	
	\label{figur}\caption{ The Pearson correlation between matrices is 0.4977. Resolution is set to $dt=0.001[s]$. The signal is cut $20[s]$ at beginning, total time is $T=530[s]=8.83[min]$.}
	
\end{figure}



\subsection{Low-pass filtered simulated BOLD activity of nodes }

\begin{figure}[htp!]
  \centering
    \begin{tabular}{cc}
    % Requires \usepackage{graphicx}
  \includegraphics[width=0.4\textwidth, height=40mm]{A_aal.eps} &    
  \includegraphics[width=0.5\textwidth, height=40mm]{nodes_BOLD_filtered_good_correlation.eps}\\ 

    \includegraphics[width=0.4\textwidth, height=40mm]{BOLD_filtered_corr_r_0_58_si_0_018.eps} &  
  \includegraphics[width=0.5\textwidth, height=40mm]{nodes_BOLD_filtered_bad_correlation.eps} \\

	\end{tabular}
	
	\label{figur}\caption{The low pass filtered BOLD activity. Pearson cor. coef. is 0.1340. }
	
\end{figure}



\subsection{Downsampled simulated BOLD activity of nodes }

\begin{figure}[htp!]
  \centering
    \begin{tabular}{cc}
    % Requires \usepackage{graphicx}
  \includegraphics[width=0.4\textwidth, height=40mm]{A_aal.eps} &    
  \includegraphics[width=0.5\textwidth, height=40mm]{nodes_BOLD_bds_good_correlation.eps}\\ 

    \includegraphics[width=0.4\textwidth, height=40mm]{BOLD_bds_corr_r_0_58_si_0_018.eps} &  
  \includegraphics[width=0.5\textwidth, height=40mm]{nodes_BOLD_bds_bad_correlation.eps} \\

	\end{tabular}
	
	\label{figur}\caption{Pearson correlation coefficient between two matrices is 0.4687. The filtered BOLD activity simulation is finally downsampled. Downsampling means selecting only some data points at some defined time interval. Here we chose the data points at every 2300 points, given by downsampling rate $ds$, which is divided by the resolution of the simulation $dt$: $\frac{2.3[s]}{0.001[s]}=2300$. At the end the signal is cut by amount of $\%4$ : $\%2$ from beginning and $\%2$ from end. }
	
\end{figure}


\newpage

\section{Fast Fourier Transform of Simulation Signals}

\subsection{Simulated Neuronal Activity}

\begin{figure}[htp!]
  \centering
    % Requires \usepackage{graphicx}
  \includegraphics[width=\textwidth, height=70mm]{fhn_and_fft.eps}   


	\label{figur}\caption{The timeseries of two randomly chosen nodes and fast Fourier transform (fft) of their activity. The resolution of timeseries is $dt=0.001[s]$ and therefore sampling frequency is $F_s=1000[Hz]$.}
	
\end{figure}



\subsection{Simulated BOLD Activity}

\begin{figure}[htp!]
  \centering
    % Requires \usepackage{graphicx}
  \includegraphics[width=\textwidth, height=70mm]{bold_signal_and_fft.eps}   


	\label{figur}\caption{The BOLD activity of two nodes and their fft graph. There is almost no signal above $f=0.05[Hz]$ and the range after $f=0.05[Hz]$ is not necessarily visualized. The resolution of the BOLD signaling is $dt=0.001[s]$, the sampling frequency is $F_s=1000[Hz]$.}
	
\end{figure}


\subsection{Filtered BOLD Activity}

\begin{figure}[htp!]
  \centering
    % Requires \usepackage{graphicx}
  \includegraphics[width=\textwidth, height=70mm]{bold_filtered_and_fft.eps}   


	\label{figur}\caption{The low-pass filtered BOLD activity of two nodes and their fft graph. The resolution of the BOLD signaling is $dt=0.001[Hz]$, sampling frequency is $F_s=1000[Hz]$. The cut-off frequency used for filtering is $Wn = 0.0005 [Hz]$}
	
\end{figure}


\subsection{Downsampled BOLD Activity}

\begin{figure}[htp!]
  \centering
    % Requires \usepackage{graphicx}
  \includegraphics[width=\textwidth, height=70mm]{bold_downsampled_and_fft.eps}   


	\label{figur}\caption{The downsampled BOLD activity of two nodes and their fft graph. Downsampling rate is $ds=2.3[s]$, the resolution of the BOLD signaling is $dt=0.001[Hz]$, sampling frequency is $F_s=1000[Hz]$. }
	
\end{figure}

\newpage

\section{MATLAB - PYTHON Difference while filtering}

\subsection{Simple Sinewave}

\begin{figure}[htp!]
  \centering
    \begin{tabular}{c}
    % Requires \usepackage{graphicx}
  \includegraphics[width=\textwidth]{sin_fft.eps} \\   
  \includegraphics[width=\textwidth]{sin_filt.eps}\\ 


	\end{tabular}	
	\label{figur}\caption{}
	
\end{figure}

\newpage


\subsection{Sample Bold Signal}

\begin{figure}[htp!]
  \centering
    \begin{tabular}{c}
    % Requires \usepackage{graphicx}
  \includegraphics[width=\textwidth]{bold_fft.eps} \\   
  \includegraphics[width=\textwidth]{bold_filt.eps}\\ 


	\end{tabular}	
	\label{figur}\caption{}
	
\end{figure}

\end{document}